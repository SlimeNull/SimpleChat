import{l as v,ad as b,o as n,a as c,w as a,c as o,k as r,u as P,t as m,b as u,d as h,F,e as x,I as w}from"./index-7e0ef185.js";import{v as B,u as s,a as q,V as _}from"./index-bc05f82b.js";import{V as A}from"./VMain-ffc5ac57.js";import{V as C,a as S}from"./VCard-4320fbb2.js";import{V as T}from"./forwardRefs-f0d558be.js";import{V as p}from"./VBtn-3a8c1ea3.js";import{V}from"./VTooltip-d7ce11d9.js";import{V as D,a as N,e as M}from"./VList-c42ec69f.js";import{V as z}from"./VContainer-e7ac744a.js";import"./_commonjsHelpers-042e6b4d.js";import"./tag-1a61e89d.js";import"./VOverlay-c00d4473.js";const E={class:"d-flex align-start"},j={class:"ms-4"},G={class:"text-h6"},H={class:"mt-8"},J={class:"mt-4"},it={__name:"ProfilePage",setup(K){const g=v(B.state.userProfile),i=v({}),U=b(),k=Number.parseInt(U.params.id),d=v([]);async function I(){s.api.user.getUserProfile(B.state.userProfile.id).then(t=>{t.isOk?g.value=t.value:s.tool.toast(t.message)})}async function O(){s.api.user.getUserProfile(k).then(t=>{t.isOk?i.value=t.value:s.tool.toast(t.message)})}async function L(){let t=null;return d.value.length!=0&&(t=d.value[0].time),s.api.post.getLatestPosts(k,20,t,null).then(e=>{if(e.isOk){const l=e.value;for(const f of l)d.value.unshift(f)}else s.tool.toast(e.message)})}async function $(t){let e=await s.api.user.checkUserIsFriend(t);if(!e.isOk){s.tool.toast(e.message);return}if(!e.value){let f=await s.api.request.requestFriend(t);if(f.isOk)s.tool.toast("已发送好友请求, 等待验证");else{s.tool.toast(f.message);return}}}async function y(t,e){return s.api.admin.setUserBan(t.id,e).then(l=>{l.isOk?(s.tool.toast(`设置完成! 用户 ${t.userName} 当前封禁状态: ${e}`),t.isBanned=e):s.tool.toast(l.message)})}return I(),O(),L(),(t,e)=>(n(),c(A,null,{default:a(()=>[o(z,null,{default:a(()=>[o(C,null,{default:a(()=>[o(S,null,{default:a(()=>[r("div",E,[r("div",null,[o(T,{size:"x-large"},{default:a(()=>[o(q,{src:P(s).info.getAvatar(i.value.avatar)},null,8,["src"])]),_:1})]),r("div",j,[r("div",G,m(P(s).info.getUserFullDisplayName(i.value.userName,i.value.nickname)),1),r("div",null,m(i.value.id),1)])]),r("div",H,m(i.value.description||"这个人很懒，什么都没有留下"),1),r("div",J,[o(p,{icon:"",onClick:e[0]||(e[0]=l=>$(i.value.id))},{default:a(()=>[o(_,{color:"primary"},{default:a(()=>[u("mdi-chat")]),_:1}),o(V,{activator:"parent",location:"bottom"},{default:a(()=>[u("聊天")]),_:1})]),_:1}),g.value.isAdmin?(n(),h(F,{key:0},[i.value.isBanned?(n(),c(p,{key:0,icon:"",class:"ms-2",onClick:e[1]||(e[1]=l=>y(i.value,!1))},{default:a(()=>[o(_,{color:"green"},{default:a(()=>[u("mdi-account-reactivate")]),_:1}),o(V,{activator:"parent",location:"bottom"},{default:a(()=>[u("解除用户封禁")]),_:1})]),_:1})):(n(),c(p,{key:1,icon:"",class:"ms-2",onClick:e[2]||(e[2]=l=>y(i.value,!0))},{default:a(()=>[o(_,{color:"red"},{default:a(()=>[u("mdi-account-cancel")]),_:1}),o(V,{activator:"parent",location:"bottom"},{default:a(()=>[u("封禁用户")]),_:1})]),_:1}))],64)):x("",!0)])]),_:1})]),_:1}),o(C,{title:"说说",class:"mt-3"},{default:a(()=>[o(D,null,{default:a(()=>[(n(!0),h(F,null,w(d.value,l=>(n(),c(N,{key:l.id,class:"mx-3 my-5"},{default:a(()=>[o(M,null,{default:a(()=>[u(m(l.time),1)]),_:2},1024),r("div",null,m(l.content),1)]),_:2},1024))),128)),d.value.length==0?(n(),c(N,{key:0,title:"你来到了没有人的荒地..."})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}};export{it as default};
